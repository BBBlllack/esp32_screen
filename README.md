# ESP32-S3 系统信息与环境监测交互终端

本项目基于 **ESP32-S3** 微控制器和 **香橙派Zero3**，结合 **ST7789 彩色 LCD 屏幕** 与 **CST816T 电容式触摸屏**，实现了一个集 **系统信息展示、图片传输与显示、环境监测交互** 为一体的嵌入式人机交互终端。

---

## 硬件选型
- 香橙派Zero3做上位机，运行上层软件和用户交互。
- esp32做下层设备，运行从上位机接受的数据并且展示给用户。
- 香橙派Zero3的串口与esp32的串口相连，esp32通过spi连接屏幕，I2C连接触控，同时连接DHT22。

---

## 功能模块

### 1. 硬件驱动与显示
- 使用 `Adafruit_GFX` 与 `Adafruit_ST7789` 驱动 240×280 分辨率 LCD。
- 通过 `TJpg_Decoder` 支持 **JPEG 图片解码与显示**，能够从串口接收 **二进制 JPEG** 或 **Base64 编码 JPEG** 并实时显示。
- 自定义图形显示，包括进度条、温湿度曲线、系统资源占用条等。
- `nginx`使用`cgi`做为用户交互接口, 将接收到的数据通过串口发送给下位机`esp32`

### 2. 电容触摸交互
- 驱动 **CST816T 电容式触摸屏**，支持 **滑动、单击、双击、长按** 等手势识别。
- 不同手势触发不同的功能，例如：
  - ⬆️ 上滑 → 显示温湿度信息
  - 👆 双击 → 显示系统资源信息
  - 其他手势 → 预留扩展功能

### 3. 环境监测
- 使用 **DHT22 温湿度传感器**，实时采集环境数据。
- 图形化显示温湿度值及进度条，直观反映环境变化。

### 4. 系统信息显示
- 支持从上位机通过串口发送 **JSON 格式的系统信息**，内容包括 CPU、内存、磁盘使用情况。
- MCU 解析 JSON 并在屏幕上以文字和进度条形式显示。

### 5. 数据传输与状态机管理
- 串口 **Serial1** 用于接收上位机发送的数据，分为三类：
  - `0x00` → 二进制 JPEG 图片传输
  - `0x01` → Base64 编码图片传输
  - `0x02` → JSON 系统信息传输
- 通过 **状态机机制** (`STATE_IDLE`, `STATE_BIMG`, `STATE_IMG`, `STATE_SYS`) 管理不同数据流，确保传输完整性与稳定性。
- 内置 **超时机制 (8s)**，防止因数据丢失导致死锁。

---

## 技术特点
- **多模态交互**：结合触摸手势、串口通信和屏幕显示，构建灵活的人机交互界面。
- **可扩展性强**：状态机架构便于后续增加更多数据类型或传输协议。
- **可移植性好**：基于开源库（Adafruit、ArduinoJson、mbedtls），方便在不同平台上复用。
- **视觉化展示**：不仅显示文本，还通过进度条和图形化方式直观展示系统与环境信息。

---

## 应用场景
- 嵌入式 **系统监控面板**
- IoT **终端数据可视化**
- **交互式智能设备**（如小型控制面板、信息终端）
- 学习和研究 **串口通信 + 图形显示 + 触摸交互** 的综合案例

---

## 依赖库
- [Adafruit GFX Library](https://github.com/adafruit/Adafruit-GFX-Library)
- [Adafruit ST7789 Library](https://github.com/adafruit/Adafruit-ST7735-Library)
- [TJpg_Decoder](https://github.com/Bodmer/TJpg_Decoder)
- [ArduinoJson](https://arduinojson.org/)
- [mbedtls (Base64 解码)](https://tls.mbed.org/)

---

## 硬件连接
- **LCD 屏幕 (ST7789)**：SPI 接口
- **电容触摸 (CST816T)**：I²C 接口
- **DHT22 传感器**：单线 GPIO
- **串口**：
  - `Serial0` → 调试输出
  - `Serial1` → 上位机数据输入

---

## 示例交互
- 向 `Serial1` 发送 JPEG 图片 → 在 LCD 上显示图像
- 向 `Serial1` 发送 JSON → 在 LCD 上显示系统状态（CPU/内存/磁盘）
- 触摸屏 **上滑** → 显示温湿度
- 触摸屏 **双击** → 显示系统信息
- 更多手势待开发`...`
---

